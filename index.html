<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Signature Generator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f4f6f8;
    }
    h2 {
      color: #333;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    select, input {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 5px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    .fields-container {
      margin-top: 20px;
    }
    .field {
      margin-bottom: 15px;
    }
    button {
      margin-top: 20px;
      padding: 10px 20px;
      background: #007bff;
      border: none;
      color: white;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }
    button:hover {
      background: #0056b3;
    }
    #signature {
      margin-top: 20px;
      padding: 15px;
      background: #e9ecef;
      border-radius: 5px;
      font-family: monospace;
    }
  </style>
</head>
<body>

  <h2>API Signature Generator</h2>

  <!-- API Dropdown -->
  <label for="api">Choose API:</label>
  <select id="api"></select>

  <!-- Dynamic fields will appear here -->
  <div class="fields-container" id="fields"></div>

  <button onclick="generateSignature()">Generate Signature</button>

  <!-- Signature result -->
  <div id="signature"></div>

  <script>
    // API fields mapping
    const apiFields = {
      "Choose the API": [],
      "Send Transaction": [
        "AGENT_CODE", "USER_ID", "AGENT_SESSION_ID", "AGENT_TXNID",
        "LOCATION_ID", "SOURCE_OF_FUND", "SENDER_NAME", "SENDER_ADDRESS",
        "SENDER_COUNTRY", "SENDER_CONTACT_NO", "SENDER_ID_TYPE", "SENDER_ID_NO",
        "SENDER_ID_ISSUE_DATE", "SENDER_ID_EXPIRY_DATE", "SENDER_DATE_OF_BIRTH",
        "SENDER_GENDER", "SENDER_NATIONALITY", "BENEFICIARY_NAME",
        "BENEFICIARY_ADDRESS", "BENEFICIARY_COUNTRY", "BENEFICIARY_CONTACT_NO",
        "BENEFICIARY_RELATION", "BENEFICIARY_ID_TYPE", "BENEFICIARY_ID_NO",
        "BENEFICIARY_ID_ISSUE_DATE", "BENEFICIARY_ID_EXPIRY_DATE",
        "BENEFICIARY_DATE_OF_BIRTH", "BENEFICIARY_GENDER",
        "BENEFICIARY_NATIONALITY", "PAYMENT_MODE", "BANK_CODE",
        "BANK_ACCOUNT_NO", "TRANSFER_AMOUNT", "CURRENCY", "PURPOSE_OF_REMITTANCE",
        "REMITTANCE_TYPE", "REMARKS"
      ],
      "Account Validation": [
        "AGENT_CODE", "USER_ID", "AGENT_SESSION_ID", "AGENT_TXNID",
        "LOCATION_ID", "BANK_CODE", "BANK_ACCOUNT_NO"
      ],
      "Get Exchange Rate": [
        "AGENT_CODE", "USER_ID", "AGENT_SESSION_ID", "AGENT_TXNID",
        "LOCATION_ID", "SOURCE_COUNTRY", "DESTINATION_COUNTRY", "CURRENCY"
      ],
      "SSF Validation": [
        "AGENT_CODE", "USER_ID", "AGENT_SESSION_ID", "AGENT_TXNID",
        "LOCATION_ID", "SSF_ID", "SSF_NAME"
      ],
      "Wallet Validation": [
        "AGENT_CODE", "USER_ID", "AGENT_SESSION_ID", "AGENT_TXNID",
        "LOCATION_ID", "WALLET_ID"
      ],
      "Fonepay Validation": [
        "AGENT_CODE", "USER_ID", "AGENT_SESSION_ID", "AGENT_TXNID",
        "LOCATION_ID", "MERCHANT_CODE", "CUSTOMER_MOBILE_NO"
      ],
      "Ammendment Request": [
        "AGENT_CODE", "USER_ID", "AGENT_SESSION_ID", "AGENT_TXNID",
        "LOCATION_ID", "TXN_REFERENCE_NO", "NEW_BENEFICIARY_NAME",
        "NEW_BENEFICIARY_CONTACT_NO", "NEW_BENEFICIARY_ADDRESS"
      ],
      "Authorized Confirmed": [
        "AGENT_CODE", "USER_ID", "AGENT_SESSION_ID", "AGENT_TXNID",
        "LOCATION_ID", "TXN_REFERENCE_NO"
      ],
      "Cancel Transaction": [
        "AGENT_CODE", "USER_ID", "AGENT_SESSION_ID", "AGENT_TXNID",
        "LOCATION_ID", "TXN_REFERENCE_NO", "CANCEL_REASON"
      ],
      "Get Current Balance": [
        "AGENT_CODE", "USER_ID", "AGENT_SESSION_ID", "AGENT_TXNID",
        "LOCATION_ID"
      ],
      "Query Txn Status": [
        "AGENT_CODE", "USER_ID", "AGENT_SESSION_ID", "AGENT_TXNID",
        "LOCATION_ID", "TXN_REFERENCE_NO"
      ]
    };

    const apiSelect = document.getElementById("api");
    const fieldsContainer = document.getElementById("fields");
    const signatureDiv = document.getElementById("signature");

    // âœ… Populate dropdown dynamically
    for (const api in apiFields) {
      const option = document.createElement("option");
      option.value = api;
      option.textContent = api;
      apiSelect.appendChild(option);
    }

    // Generate input fields when API changes
    apiSelect.addEventListener("change", () => {
      const selectedAPI = apiSelect.value;
      const fields = apiFields[selectedAPI];
      fieldsContainer.innerHTML = "";

      if (fields && fields.length > 0) {
        fields.forEach(field => {
          const div = document.createElement("div");
          div.className = "field";
          div.innerHTML = `<label>${field}</label><input type="text" id="${field}" placeholder="Enter ${field}">`;
          fieldsContainer.appendChild(div);
        });
      }
    });

    // Dummy SHA-256 generator (replace with backend call)
    async function generateSignature() {
      const selectedAPI = apiSelect.value;
      if (!selectedAPI || selectedAPI === "Choose the API") {
        alert("Please select an API first!");
        return;
      }

      const fields = apiFields[selectedAPI];
      let inputString = "";
      fields.forEach(field => {
        const value = document.getElementById(field).value || "";
        inputString += `<${field}>${value}</${field}>`;
      });

      // Hash input string using SHA-256
      const encoder = new TextEncoder();
      const data = encoder.encode(inputString);
      const hashBuffer = await crypto.subtle.digest("SHA-256", data);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      const hashHex = hashArray.map(b => b.toString(16).padStart(2, "0")).join("");

      signatureDiv.innerHTML = `<strong>Generated Signature:</strong><br>${hashHex}`;
    }
  </script>

</body>
</html>
